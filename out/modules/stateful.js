(function(){var t,e,r,i,n,o,s=function(t,e){function r(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},a={}.hasOwnProperty;t=require("./core.object"),i=require("stately.js"),n=require("when"),o=require("lodash"),e=require("sublime-error"),e.mixins.value(),r=function(t){function r(t,n){e.Throw.isNullOrUndefined(t,"states"),r.__super__.constructor.call(this),this.machine=i.machine(t,n),this.state=function(){return this.machine.getMachineState()},this.machine.bind(function(t,e,r){var i;return i={event:t,oldState:e,newState:r},this.emit(t,this,i),e!==r?this.emit(r,this,i):void 0}.bind(this))}return s(r,t),r.prototype.apply=function(){var t;return e.Throw.isUnspecified(arguments[0],"method name"),t=Array.prototype.slice.call(arguments,1),this.machine[arguments[0]].apply(this,t),this},r.prototype.promise=function(){var t,r;return e.Throw.isUnspecified(arguments[0],"method name"),r=n.defer(),t=Array.prototype.slice.call(arguments,1),this.apply.apply(this,[arguments[0],this,r].concat(t)),r.promise},r}(t),module.exports=r}).call(this);
